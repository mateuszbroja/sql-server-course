# 310. Test praktyczny

1. Wyświetl miasta, w których są klienci, ale w których nie ma sklepów.

2. Znajdź wszystkich klientów, których nazwiska kończą się na literę **`n`** oraz mają trzecią literę imienia **`m`**. Posortuj ich alfabetycznie po imieniu.

3. Dla każdego pracownika wyświetl ile dni temu został zatrudniony. Dodatkowo wyświetl kolumnę, która pokaże, czy pracownik jest nadal zatrudniony, czy nie.

4. Wypisz nazwę produktów oraz liczbę liter w nazwie dla tych produktów, których nazwa ma 50 lub więcej znaków.

5. Zwróć jaki był stosunek pomiędzy zamówieniami z obniżką, a tych bez obniżki.

6. Pokaż ile mniej wydał klient, który wydał najmniej pieniędzy w stosunku do tego, który wydał najwięcej. Pomiń **`discount`**.

7.  Wyświetl produkty, których ceny są mniejsze niż 300 $ lub większe niż 2000 $.

8. Pokaż rekordy które są zduplikowane.

9. Pokaż zamówienia, w których znajduje się przynajmniej 51 rzeczy (nie pozycji w zamówieniu) oraz wyklucz te zamówienia, które zostały zamówione przez pracowników, którzy już nie pracują.

10.  Wyświetl pracowników, którzy mogą być również klientami sklepu. Zweryfikuj to po imieniu i nazwisku.

11.  Wyświetl wszystkich klientów, którzy złożyli zamówienia w **`2017`** roku.

12. Dla każdego miesiąca roku podaj wartość sprzedaży (ma być 12 rekordów w tabeli wynikowej).

13. Pokaż produkty, które zostały zamówione mniej niż 1100 razy.

14. Pokaż ile zajmuje wysłanie zamówienia przez poszczególne sklepy.

15. Wyświetl 10% produktów, które kosztują najwięcej.

16. Wyświetl nazwę produktu, ile było sprzedanych tych produktów, ich kategorię oraz ilość sprzedanych produktów w każdej z kategorii.

17. Wyświetl nazwę produktu, ile było sprzedanych tych produktów, ich kategorię oraz ilość sprzedanych produktów w każdej z kategorii.

18. Wyświetl wszystkie występujące imiona i nazwiska pracowników w jednej kolumnie o nazwie **`first_last_name`**.

19. Wyznacz średnią wartość zamówień w roku dla każdego klienta, który dokonał co najmniej jednego zamówienia w każdym roku, w którym zostało dokonane jakiekolwiek zamówienie.

20. Zwróć imię i nazwisko pracownika oraz sumę ilości sprzedanych produktów w 2022 oraz w 2023 roku (w osobnych kolumnach). W przypadku braku sprzedaży w danym roku, w kolumnie wyświetl **`0`**. 

21. Zapytanie to wybiera nazwę produktu, cenę oraz ranga ceny produktu, wyznaczona za pomocą funkcji `RANK()` oraz `DENSE_RANK()`. Wyniki są sortowane malejąco po cenie produktu.

22. Wyświetl nazwę produktu, cenę, nazwę sklepu oraz ilość sprzedanych sztuk dla TOP 5 najlepiej sprzedających się produktów w **`2022`**. Dla każdego z produktu pokaż podział na poszczególne sklepy. Ostatecznie ma się pojawić **`5 x ilość sklepów`** rekordów.

23. Dla każdej kategorii policz liczbę produktów kosztujących więcej niż 1500 $. Jeżeli kategoria nie posiada żadnych produktów droższych niż 1500 $, to i tak pokaż kategorię z liczbą **`0`**.